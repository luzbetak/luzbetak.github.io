---
---
{% include menu.html title="WITH 2 Tables JOIN" %}

<pre><code class="language-sql">WITH 
-- ---------------------------------------------------------------------------- --
Student_Table AS (
    SELECT * FROM students
    WHERE LOWER(subject) LIKE LOWER('%Artificial Intelligence%')
       OR LOWER(subject) LIKE LOWER('%Large Lnaguage Model%')
),
-- ---------------------------------------------------------------------------- --
Curriculum_Table AS (
    SELECT * FROM curriculum
    WHERE LOWER(body) LIKE LOWER('%Graduated%')
)
-- ---------------------------------------------------------------------------- --
SELECT *
FROM Student_Table 
JOIN Curriculum_Table ON Student_Table.student_id = Curriculum_Table.student_id

ORDER BY RAND() LIMIT 100;
-- ---------------------------------------------------------------------------- --
</code></pre>
<hr>
<pre><code class="language-sql">WITH 
-- ---------------------------------------------------------------------------- --
Filtered_Students AS (
    SELECT student_id, first_name, last_name, email, major 
    FROM students 
    WHERE 
           LOWER(major) LIKE LOWER('%Artificial Intelligence%') 
        OR LOWER(major) LIKE LOWER('%Large Language Model%')
),
-- ---------------------------------------------------------------------------- --
Filtered_Curriculum AS (
    SELECT curriculum_id, student_id, curriculum_name, program_type 
    FROM curriculum 
    WHERE 
        LOWER(program_type) LIKE LOWER('%Graduated%')
),
-- ---------------------------------------------------------------------------- --
Grades_Table AS (
    SELECT student_id, course_id, grade, semester 
    FROM grades 
    WHERE grade IS NOT NULL
),
-- ---------------------------------------------------------------------------- --
Courses_Table AS (
    SELECT course_id, course_name, instructor 
    FROM courses
),
-- ---------------------------------------------------------------------------- --
Joined_Results AS (
    SELECT s.student_id, s.first_name, s.last_name, s.email, 
           c.curriculum_name, 
           g.grade, g.semester, 
           cr.course_name, cr.instructor

    FROM Filtered_Students AS s
    JOIN Filtered_Curriculum AS c ON s.student_id = c.student_id
    JOIN Grades_Table AS g        ON s.student_id = g.student_id
    JOIN Courses_Table AS cr      ON g.course_id  = cr.course_id
)
-- ---------------------------------------------------------------------------- --
SELECT * 
FROM Joined_Results
ORDER BY RAND() 
LIMIT 100;
-- ---------------------------------------------------------------------------- --
</code></pre>

  {% include footer.html %}

  </body>
</html>
